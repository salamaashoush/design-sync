"use strict";var j=require("path"),M=require("fs"),E=require("module"),i=require("get-tsconfig"),f=require("../source-map.cjs"),d=require("../index-ff7a6932.cjs"),O=require("../resolve-ts-path-43f50656.cjs");require("source-map-support"),require("../node-features-84a305a1.cjs"),require("url"),require("esbuild"),require("crypto"),require("os");function m(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var p=m(j),q=m(M),l=m(E);const P=s=>{if(s.includes("import")||s.includes("export")){const[e,n]=d.parseEsm(s);return e.length>0||n.length>0}return!1},b=/^\.{1,2}\//,A=/\.[cm]?tsx?$/,N=`${p.default.sep}node_modules${p.default.sep}`,u=process.env.TSX_TSCONFIG_PATH?{path:p.default.resolve(process.env.TSX_TSCONFIG_PATH),config:i.parseTsconfig(process.env.TSX_TSCONFIG_PATH)}:i.getTsconfig(),S=u&&i.createFilesMatcher(u),x=u&&i.createPathsMatcher(u),y=f.installSourceMapSupport(),v=l.default._extensions,R=v[".js"],D=[".cts",".mts",".ts",".tsx",".jsx"],I=[".js",".cjs",".mjs"],F=(s,e)=>{process.send&&process.send({type:"dependency",path:e});const n=D.some(r=>e.endsWith(r)),o=I.some(r=>e.endsWith(r));if(!n&&!o)return R(s,e);let t=q.default.readFileSync(e,"utf8");if(f.shouldStripSourceMap&&(t=f.stripSourceMap(t)),e.endsWith(".cjs")){const r=d.transformDynamicImport(e,t);r&&(t=y(r,e))}else if(n||P(t)){const r=d.transformSync(t,e,{tsconfigRaw:S==null?void 0:S(e)});t=y(r,e)}s._compile(t,e)};[".js",".ts",".tsx",".jsx"].forEach(s=>{v[s]=F}),Object.defineProperty(v,".mjs",{value:F,enumerable:!1});const _=l.default._resolveFilename.bind(l.default);l.default._resolveFilename=(s,e,n,o)=>{var t;const r=s.indexOf("?");if(r!==-1&&(s=s.slice(0,r)),x&&!b.test(s)&&!((t=e==null?void 0:e.filename)!=null&&t.includes(N))){const a=x(s);for(const T of a){const h=g(T,e,n,o);if(h)return h;try{return _(T,e,n,o)}catch{}}}const c=g(s,e,n,o);return c||_(s,e,n,o)};const g=(s,e,n,o)=>{const t=O.resolveTsPath(s);if(e!=null&&e.filename&&A.test(e.filename)&&t)for(const r of t)try{return _(r,e,n,o)}catch(c){const{code:a}=c;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw c}};
